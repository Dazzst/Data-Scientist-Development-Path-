## 数据预处理 Data preprocessing

##（1）在进行数据清洗时，重点处理以下几类数据：

1.  **缺失值：** 处理数据中的缺失值，可以通过填充缺失值、删除缺失值所在的行或列，或者使用模型预测填充等方法来处理。
2.  **异常值：** 识别和处理数据中的异常值，可以通过统计方法、可视化分析或使用模型来检测和处理异常值。
3.  **重复值：** 识别和处理数据中的重复值，可以通过对数据集进行排序、使用重复值检测函数或者模型来处理重复值。
4.  **格式错误：** 处理数据中的格式错误，例如数据类型错误、日期格式错误等。
5.  **不一致的数据：** 处理数据中不一致的数据，例如名字的大小写不一致、单位的不统一等。

##（2）数据清洗的基本流程如下：

1.  **数据导入：** 将原始数据导入到数据清洗的环境中。
2.  **观察和初步分析：** 对数据进行观察和初步分析，包括查看数据的结构、大小、缺失值等情况。
3.  **处理缺失值：** 识别并处理数据中的缺失值。
4.  **处理异常值：** 识别并处理数据中的异常值。
5.  **处理重复值：** 识别并处理数据中的重复值。
6.  **处理格式错误：** 处理数据中的格式错误。
7.  **处理不一致的数据：** 处理数据中的不一致的数据。
8.  **数据导出：** 将清洗后的数据导出，供后续分析使用。


## 除了上述提到的几类数据，数据清洗中还需要关注：

1.  **数据类型不匹配 (Schema Mismatch)：**

      * **描述：** 确保每列数据的实际存储类型（如字符串、数值、日期）与预期的数据类型一致。
      * **处理方法：** 强制类型转换，例如将本应是数值的列从字符串转换为浮点数或整数，将日期字符串转换为标准的日期时间格式。

2.  **数据逻辑错误 (Logical Errors)：**

      * **描述：** 数据本身在逻辑上不合理，例如年龄为负数、购买数量为零、或者某个时间戳早于前一个相关的时间戳。
      * **处理方法：** 设定业务规则或逻辑约束进行校验，将不符合逻辑的记录标记为异常值或直接修正。

3.  **冗余特征 (Redundant Features)：**

      * **描述：** 数据集中存在大量高度相关或信息重复的特征列。
      * **处理方法：** 使用相关性分析、**主成分分析 (PCA)** 等方法进行**特征选择**或**特征降维**。


## 在基本流程的基础上，可以增加以下关键步骤，使流程更加严谨：

1.  **（新增）数据质量报告生成：**

      * **位置：** 介于“观察和初步分析”之后。
      * **描述：** 在开始清洗之前，生成一份详细的报告，量化地展示缺失值比例、异常值分布、重复值数量、各列的数据类型和唯一值数量等，作为清洗工作的基线。

2.  **（细化）缺失值处理：**

      * **细化点：** 在填充缺失值时，需根据数据特性选择合适的填充策略，如：**均值/中位数/众数填充**（适用于随机缺失）、**前一个/后一个观测值填充 (LOCF/NOCF)**（适用于时间序列数据）、**使用机器学习模型进行预测填充**（适用于非随机缺失）。

3.  **（细化）异常值处理：**

      * **细化点：** 异常值的处理不总是删除。可以采用**封顶和封底 (Capping and Flooring)**（将极端值替换为某个分位数，如 $99.5^{th}$ 或 $0.5^{th}$）或将异常值单独分组进行建模分析。

4.  **（新增）数据标准化/归一化：**

      * **位置：** 在所有数据值处理完毕，数据导出之前。
      * **描述：** 为了后续机器学习模型的训练，对数值特征进行缩放处理，如**Min-Max 归一化**（将数据缩放到 [0, 1] 范围）或 **Z-Score 标准化**（将数据转换为均值为 0，标准差为 1 的分布）。

5.  **（新增）特征工程：**

      * **位置：** 在数据导出之前，可以与标准化/归一化并行。
      * **描述：** 基于现有数据创建新的、更有意义的特征，例如从日期时间中提取年、月、日、星期几；对分类特征进行 **One-Hot 编码**或**标签编码**；对数值特征进行分箱。

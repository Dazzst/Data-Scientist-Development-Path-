# R语言数据科学

## 🎯 概览：R是什么？

| 特性 | 描述 |
| :--- | :--- |
| **定义** | 专为统计计算、数据分析和图形设计而生的**编程语言与环境**。 |
| **核心优势** | 统计建模能力强大、图形可视化（`ggplot2`）精美、拥有庞大的**开源包生态**。 |
| **环境** | 推荐使用**RStudio**作为集成开发环境（IDE）。 |
| **赋值符号** | 核心赋值运算符是 `<-`（例如：`x <- 10`），而非 `=`。 |

## 📦 核心数据结构 (Data Structures)

R中的一切皆为对象。理解其数据结构是高效编程的关键。

| 结构 | 描述 | 示例代码 |
| :--- | :--- | :--- |
| **1. 向量 (Vector)** | 最基本的结构，存储**单一类型**（数值、字符、逻辑值）的数据集。 | `v <- c(1, 5, 8)` |
| **2. 矩阵 (Matrix)** | 二维数组，存储**单一类型**数据。常用于线性代数。 | `m <- matrix(1:4, nrow=2)` |
| **3. 数组 (Array)** | 多维数组，存储**单一类型**数据。 | `a <- array(1:8, dim=c(2, 2, 2))` |
| **4. 数据框 (Data Frame)** | **最常用结构**。列是向量，每列可存储**不同类型**数据（如表格）。 | `df <- data.frame(ID, Value)` |
| **5. 列表 (List)** | **最灵活结构**。可包含任何R对象（向量、矩阵、数据框、甚至其他列表）。 | `l <- list(v, df, "Text")` |

## 🛠️ 数据处理与转换 (Tidyverse - Dplyr)

现代R语言主要通过 **Tidyverse** 库集合进行数据处理。`dplyr` 包是其中的核心。

| 动词 (Verb) | 功能描述 | 示例 (使用管道操作符 `|>` 或 `%>%`) |
| :--- | :--- | :--- |
| `filter()` | 筛选：按条件**选取行**。 | `df |> filter(Age > 30)` |
| `select()` | 选择：按名称**选取列**。 | `df |> select(Name, Age)` |
| `mutate()` | 转换：**创建新列**或修改现有列。 | `df |> mutate(BMI = Weight / Height^2)` |
| `arrange()` | 排序：按列值对行进行排序。 | `df |> arrange(desc(Score))` |
| `group_by()` | 分组：将数据按一列或多列分组。 | `df |> group_by(City)` |
| `summarise()` | 汇总：对分组后的数据进行**聚合计算**（如求平均值）。 | `df |> summarise(Avg_Age = mean(Age))` |
| **管道** | 连接多个操作步骤，使代码更具可读性。 | `df |> group_by(A) |> summarise(B = max(B))` |

## 📊 数据可视化 (Ggplot2)

`ggplot2` 基于**图形语法 (Grammar of Graphics)**，通过图层叠加创建图形。

| 概念 | 描述 | 核心函数/参数 |
| :--- | :--- | :--- |
| **数据 (Data)** | 绘图所需的数据框。 | `ggplot(data = df, ...)` |
| **映射 (Aesthetics, aes)** | 将数据变量映射到视觉特征（如 X/Y 轴、颜色、大小）。 | `aes(x = Var1, y = Var2, color = Group)` |
| **几何对象 (Geom)** | 定义图形的类型（点、线、柱等）。 | `+ geom_point()` (散点图) |
| **统计变换 (Stat)** | 对数据进行统计汇总（如直方图的计数）。 | `+ stat_smooth()` (平滑曲线) |
| **坐标系 (Coord)** | 定义坐标系类型（笛卡尔、极坐标等）。 | `+ coord_flip()` |
| **分面 (Facet)** | 将图形按某个变量的水平拆分成多个小图。 | `+ facet_wrap(~Group)` |

## 📉 统计建模 (Statistical Modeling)

R是统计建模的首选工具。

| 模型 | 函数 | 描述 |
| :--- | :--- | :--- |
| **线性回归** | `lm()` (Linear Model) | 拟合线性关系。 `model <- lm(y ~ x1 + x2, data = df)` |
| **广义线性模型** | `glm()` (Generalized Linear Model) | 拟合非正态分布响应变量（如逻辑回归）。 |
| **模型信息** | `summary()` | 查看模型的详细统计信息（系数、p值等）。 |
| **诊断图** | `plot(model)` | 绘制诊断图，检查模型的假设是否满足。 |
| **预测** | `predict()` | 使用拟合的模型对新数据进行预测。 |

## 📚 常用函数与技巧

| 类型 | 函数/符号 | 作用 |
| :--- | :--- | :--- |
| **注释** | `#` | 单行注释。 |
| **包管理** | `install.packages("pkg")` | 安装新的R包。 |
| **包管理** | `library(pkg)` | 加载已安装的R包以供使用。 |
| **序列生成** | `1:5` 或 `seq(1, 5)` | 生成数字序列 `1, 2, 3, 4, 5`。 |
| **组合** | `c()` | 创建向量（`combine`）。 |
| **结构查看** | `str()` | 查看任何R对象的内部结构和类型（非常有用）。 |
| **表格查看** | `head()` / `tail()` | 查看数据框的前几行或后几行。 |


## 📦 核心数据结构 (Data Structures) - 补充细节

### A. 数据类型 (Atomic Types)

R语言的原子类型是构成所有数据结构的基本元素。

| 类型 | 描述 | 示例 |
| :--- | :--- | :--- |
| **Numeric** | 包含整数 (Integer) 和浮点数 (Double)，是默认的数值类型。 | `10`, `3.14` |
| **Integer** | 显式声明的整数，在数字后加 `L`。 | `10L` |
| **Character** | 字符串或文本。 | `"hello world"` |
| **Logical** | 逻辑值，只有 `TRUE` 或 `FALSE`。 | `T`, `F` |
| **Complex** | 复数。 | `1 + 4i` |

### B. 特殊值 (Special Values)

在处理数据时，经常会遇到代表缺失或异常的值。

| 值 | 含义 | 描述 |
| :--- | :--- | :--- |
| **NA** | Not Available (缺失值) | 表示数据点丢失或无法获取。 |
| **NaN** | Not a Number (非数值) | 0/0 或 `Inf - Inf` 等运算结果。 |
| **Inf** | Infinity (无穷大) | 1/0 等运算结果。 |
| **NULL** | 空对象 | 表示没有对象，常用于函数返回值或列表初始化。 |

## ⚙️ 编程控制流 (Control Flow)

### A. 条件语句

| 语句 | 作用 | 示例代码 |
| :--- | :--- | :--- |
| `if/else` | 基于条件执行代码块。 | `if (x > 0) { ... } else { ... }` |
| `ifelse()` | **向量化**的条件选择函数，常用在`mutate()`中。 | `df |> mutate(Is_High = ifelse(Score > 90, TRUE, FALSE))` |
| `switch()` | 根据表达式的值选择执行的分支。 | `switch(var, "a" = 1, "b" = 2, default = 0)` |

### B. 循环结构

| 语句 | 作用 | 推荐用法 |
| :--- | :--- | :--- |
| `for` | 遍历序列中的每个元素并执行代码。 | 适用于简单迭代或生成输出。 |
| `while` | 当条件为真时重复执行代码块。 | 适用于不知道迭代次数的情况。 |
| **Apply 家族** | `lapply()`, `sapply()` 等 | **更推荐**。对数据结构（如列表、数据框）进行高效、向量化的操作。 |

## 📈 统计建模与进阶 (Advanced Modeling)

| 概念 | 函数 | 描述 |
| :--- | :--- | :--- |
| **模型公式** | `y ~ x1 + x2` | R中定义模型的基础语法，`~` 左边是因变量，右边是自变量。 |
| **交互项** | `y ~ x1 * x2` | 包含 `x1`, `x2` 以及它们之间的乘积项（交互作用）。 |
| **非线性项** | `y ~ I(x^2)` | 使用 `I()` (AsIs) 告诉R按字面意思处理复杂表达式。 |
| **交叉验证** | `caret` 或 `tidymodels` 包 | 用于评估模型在新的、未见数据上的泛化能力。 |
| **时间序列** | `ts()` 或 `xts` 包 | 处理带有时间索引的数据，常用于金融和经济预测。 |
| **聚类** | `kmeans()` | 无监督学习方法，用于将数据分成若干组（簇）。 |
